<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Trunk v0.10 – v0.13 | Trunk | Build, bundle &amp; ship your Rust WASM application to the web </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <style>
    :root {
        /* Primary theme color */
        --primary-color: #FED43F;
        /* Primary theme text color */
        --primary-text-color: #543631;
        /* Primary theme link color */
        --primary-link-color: #F9BB2D;
        /* Secondary color: the background body color */
        --secondary-color: #fcfaf6;
        --secondary-text-color: #303030;
        /* Highlight text color of table of content */
        --toc-highlight-text-color: #d46e13;
    }
</style>
    <link href="https://fonts.googleapis.com/css?family=Alfa+Slab+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans:400,500,600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/normalize.css">
    <link rel="stylesheet" href="https:&#x2F;&#x2F;trunkrs.dev&#x2F;juice.css">
    

<link rel="icon" type="image/svg+xml" href="https:&#x2F;&#x2F;trunkrs.dev&#x2F;rustacean-flat-happy.svg">

<link rel="stylesheet" type="text/css" href="/blog-post.css">

</head>

<body>
    
<header class="box-shadow">
    

<a href="https:&#x2F;&#x2F;trunkrs.dev&#x2F;">
    <div class="logo">
        <img src="https:&#x2F;&#x2F;trunkrs.dev&#x2F;rustacean-flat-happy.svg" alt="logo">
        Trunk
    </div>
</a>

<nav>
    
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;trunkrs.dev&#x2F;assets&#x2F;">Assets</a>
    
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;trunkrs.dev&#x2F;configuration&#x2F;">Configuration</a>
    
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;trunkrs.dev&#x2F;commands&#x2F;">Commands</a>
    
    
        
        <a class="nav-item subtitle-text" href="&#x2F;blog&#x2F;">Blog</a>
        
        <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;github.com&#x2F;thedodd&#x2F;trunk">Github</a>
        
    
</nav>

</header>


    <main>
        
        
        
        
        
        <div class="toc">
            <div class="toc-sticky">
                
                <div class="toc-item">
                    <a class="subtext" href="https://trunkrs.dev/blog/v10-v13/#automatic-tool-downloads">Automatic Tool Downloads</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://trunkrs.dev/blog/v10-v13/#tokio-axum">Tokio &amp; Axum</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://trunkrs.dev/blog/v10-v13/#other-features-fixes">Other Features &amp; Fixes</a>
                </div>
                
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://trunkrs.dev/blog/v10-v13/#indicatif"><small>- indicatif</small></a>
                </div>
                
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://trunkrs.dev/blog/v10-v13/#conclusion">Conclusion</a>
                </div>
                
                
            </div>
        </div>
        
        

        <div class="content text">
            
<div class="trunk-blog-author">
    
    <p>Author: Doddzilla</p>
    
    
    <p>Date: 2021-08-05</p>
    
</div>

<h1>Trunk v0.10 – v0.13</h1>


<p class="subtext">Automatic wasm-bindgen &amp; wasm-opt downloads, cut over to Tokio &amp; Axum, and various other features and fixes.</p>


<p>Hello fellow Rustaceans! It's been quite some time since our last blog post. We've seen 5 releases since then, so we've got a lot to cover.</p>
<h2 id="automatic-tool-downloads">Automatic Tool Downloads</h2>
<p>After building wasm-opt integration for Trunk, <code>dnaka91</code> then built a system which is able to automatically download and install <code>wasm-bindgen</code> &amp; <code>wasm-opt</code> if they are missing from the host system. This system will check the version of <code>wasm-bindgen</code> being used by the parent application and will ensure that the versions match. External tools downloaded by this system are cached in a well-defined location based on the host OS.</p>
<p>Overall this feature lowers the barrier of entry for getting started with Trunk. It was quite common that folks in the community discord would drop in with an error message indicating that Trunk was not able to call <code>wasm-bindgen</code> (the error message was not so great). Now, such issues should be a thing of the past.</p>
<p>There is a lot of great potential with this feature. There has been some good discussion in the community around moving away from our current sass solution, which is to link to a C-based sass lib, and instead to use our new download system to pull down <a href="https://sass-lang.com/dart-sass">dart-sass</a>. This is the primary sass implementation these days, getting all of the new features before any of the other implementations. More design work to be done here, but this could be a big win.</p>
<p>Not only does this apply to sass, but this could apply to any other integrations we build in the future. Especially in cases where the integration is a standalone binary which we can download and call. This will quite likely be an important piece of our plugin system once the plugin system is ready for prime time.</p>
<h2 id="tokio-axum">Tokio &amp; Axum</h2>
<p>Trunk has shipped with a static file server from the beginning. Somewhere along the way we added support for HTTP proxies, and then WebSocket proxies after that. Originally, Trunk was based on the <code>async-std</code> runtime, so we used <code>tide</code> for all things HTTP.</p>
<p>The Rust community evolves quickly. The async runtime ecosystem, even faster. Not long ago, the Tokio team released <a href="https://tokio.rs/blog/2020-12-tokio-1-0">Tokio 1.0</a>. This was a big win for the Rust ecosystem overall. Since then, they've continued to crank out new 1.x releases, along with new support libraries, io_uring support (love it), as well as a new server framework called <a href="https://github.com/tokio-rs/axum">Axum</a> (<a href="https://tokio.rs/blog/2021-07-announcing-axum">blog post</a>).</p>
<p>All that to say, I decided to cut Trunk over to the Tokio ecosystem, and while I was in the middle finishing up that work, I found myself wishing that we had a nice, simple, ergonomic web framework for Tokio ... and then literally the very next day Axum was released. This couldn't have come at a better time. Axum is built on Hyper &amp; Tower, so it has direct interoperability with that entire ecosystem. This made the switch rather simple on the Trunk side.</p>
<p>I have to say, I'm quite stoked. Very happy with how this turned out for Trunk, and happy to see this new option come about for the Rust ecosystem. The wins here are obvious, but the biggest win is that we have a greater stability guarantee overall, and the success of the Tokio ecosystem to draw from.</p>
<h2 id="other-features-fixes">Other Features &amp; Fixes</h2>
<p>Lots of big wins so far, but these last few releases have also seen many other smaller features and fixes. Let's take a look.</p>
<h3 id="indicatif"><code>indicatif</code></h3>
<p>After sinking more time than I care to admit, and finding myself frustrated rather often with <code>indicatif</code>, I decided to completely remove it from Trunk. Now, to be sure, <code>indicatif</code> is great, and its maintainer is quite literally a hero among the greater software community, but the difficulties I ran into here seemed to be more closely related to async interop.</p>
<p>Without going into too many details, deadlocks from progress bars, consoles not clearing properly, inflexibility of design, all of these things were causing me to spend more time on the console than spending time building other <strong>real</strong> features for Trunk. So, I decided to instead just use the good ol' <a href="https://github.com/tokio-rs/tracing">tracing</a> crate, and now things are quite stable.</p>
<p>Truth be told, I would love to circle back at some point in the future and add a nicer console UI to Trunk. This is currently fairly low priority for me, as this is purely aesthetic. If you are passionate about such things, drop by our community discord and let us know!</p>
<p>There are many other features and fixes of note. Have a look at the <a href="https://github.com/thedodd/trunk/blob/master/CHANGELOG.md">changelog</a> for more details.</p>
<h2 id="conclusion">Conclusion</h2>
<p>All in all, some great progress for Trunk. As far as Trunk's future, the plugin system and exploring patterns around code splitting and HMR are the things I'm most excited about.</p>
<p>As a community, building web apps in Rust, finding the pain points, and then working together to fix them, that is how we make progress. Let's keep on pushing forward!</p>
<p>Cheers!</p>


        </div>

    </main>

    
<footer>
    <p>
        <small class="subtext text-center">
            <a href="https://github.com/thedodd/trunk">Trunk Maintainers</a> © 2021
        </small>
    </p>
    <p class="subtext text-center">
        Ferris the crab is public domain. This Ferris can be found at
        <a href="https://rustacean.net/">rustacean.net</a>
        and in the hearts of Rust users throughout the galaxy!
    </p>
</footer>

</body>
<script>
    function highlightNav(heading) {
        let pathname = location.pathname;
        document.querySelectorAll(".toc a").forEach((item) => {
            item.classList.remove("active");
        });
        document.querySelector(".toc a[href$='" + pathname + "#" + heading + "']").classList.add("active");
    }

    let currentHeading = "";
    window.onscroll = function () {
        let h = document.querySelectorAll("h1,h2,h3,h4,h5,h6");
        let elementArr = [];

        h.forEach(item => {
            if (item.id !== "") {
                elementArr[item.id] = item.getBoundingClientRect().top;
            }
        });
        elementArr.sort();
        for (let key in elementArr) {
            if (!elementArr.hasOwnProperty(key)) {
                continue;
            }
            if (elementArr[key] > 0 && elementArr[key] < 300) {
                if (currentHeading !== key) {
                    highlightNav(key);
                    currentHeading = key;
                }
                break;
            }
        }
    }
</script>

</html>
